<tool id="ReactomePA" name="Reactome Pathway enrich Analysis of a gene set" version="0.1.0">
    <description>Input a vector of all different expression gene and Output the enriched Significant Reactome Pathways</description>
    <requirements>
        <requirement type="package" version="1.20.3">r-getopt</requirement>
        <requirement type="package" version="1.34.0">bioconductor-ReactomePA</requirement>
        <requirement type="package" version="3.12.0">bioconductor-org.Hs.eg.db</requirement>
    </requirements>
    <command detect_errors="exit_code" interpreter="Rscript --vanilla"><![CDATA[
        $__tool_directory__/ReactomePA.R   
        -g '$gene_list_file' 
        -s '$Significant_Reactome_Pathway_result' 
        
        -o '$organism'
        
        -p '$adv.pvalueCutoff' 
        -w '$adv.pAdjustMethod' 
        #if $adv.convertId=="TRUE":
        -c
        #end if
        -i '$adv.minGSSize' 
        -a '$adv.maxGSSize'
    ]]></command>

    <inputs>
        <param type="data" name="gene_list_file" format="csv" label="Different expression genes" help="An CSV file included DEgenes column that is all different expression genes with entrez id." />
        <param type="select" name="organism" label="Organism" help="Choose organism for you data. Here only supposted human, rat, mouse, celegans, yeast, zebrafish and fly.">
            <option value="human" selected="True">human</option>
            <option value="rat">rat</option>
            <option value="mouse">mouse</option>
            <option value="celegans">celegans</option>
            <option value="yeast">yeast</option>
            <option value="zebrafish">zebrafish</option>
            <option value="fly">fly</option>
        </param>
        
        <section name="adv" title="Advanced Options" expanded="false">

            <param type="float" name="pvalueCutoff" value="0.05" min="0.00" max="1.00" label="P-value threshold" help="Default as 0.05. The value is to cut off the P-value of pathway."/>
            
            <param type="select" name="pAdjustMethod" label="Method for Adjust p-value of pathway" help="Choose one method to adjust p-value of pathway.">
                <option value="BH" selected="True">BH</option>
                <option value="holm">holm</option>
                <option value="hochberg">hochberg</option>
                <option value="hommel">hommel</option>
                <option value="bonferroni">bonferroni</option>
                <option value="BY">BY</option>
                <option value="fdr">fdr</option>
                <option value="none">none</option>
            </param>
            <param type="boolean" name="convertId" truevalue="TRUE" falsevalue="FALSE" checked="false" label="Convert gene ID to SYMBOL" help="Select Yes if you want to convert entrez gene id to gene name, see the Help section below. Default: No." />
            
            <param type="integer" name="minGSSize" value="10" label="Minimal size of each geneSet" help="Minimal size of genes annotated by Ontology term for testing"/>
            <param type="integer" name="maxGSSize" value="500" label="Maximal size of each geneSet" help="Maximal size of each geneSet for analyzing" />
        </section>
    </inputs>
    
    
    <outputs>
        <data name="Significant_Reactome_Pathway_result" format="csv" label="Significant_Reactome_Pathway_result" />
    </outputs>
    <tests>
        <test>
            <param name="gene_list_file" value="Different_expression_gene.csv" ftype="csv" />
            <param name="organism" value="human"/>
            <param name="minGSSize" value="15"/>
            <param name="maxGSSize" value="200"/>
            <param name="pvalueCutoff" value="0.06"/>
            <param name="pAdjustMethod" value="holm"/>
            <param name="input7" value="true"/>
            <output name="Significant_Reactome_Pathway_result" file="t1.csv" ftype="csv" />
        </test>
    </tests>
    <help><![CDATA[
.. class:: infomark 

**What it does**

Reactome_ is a free, open-source, curated and peer-reviewed pathway database. 
Our goal is to provide intuitive bioinformatics tools for the visualization, 
interpretation and analysis of pathway knowledge to support basic research, 
genome analysis, modeling, systems biology and education. 

.. _Reactome: https://reactome.org

Reactome Pathway enrich Analysis of a gene set is a tool to enrich Significant Reactome Pathways with a list of different expression genes.

This tool uses function `enrichPathway` in ReactomePA_ package.

.. _ReactomePA: http://www.bioconductor.org/packages/release/bioc/html/ReactomePA.html

---------

==========
**Inputs**
==========

Basic Options
--------------

**Different expression genes**

This tool requires an CSV file which has `DEgenes` column contained all different expression entrez genes id.

Example - **DE genes file**

    ========== === 
    DEgenes     
    ========== === 
    4312
    8318
    10874
    55143
    55388
    991
    ========== === 

**Organism**

Choose organism for you data. Here only supposted human, rat, mouse, celegans, yeast, zebrafish and fly.



Advanced Options
-----------------

**P-value threshold**

Default as 0.05. The value is to cut off the P-value of pathway.

**Method for Adjust p-value of pathway**

Choose one method to adjust p-value of pathway. Here supposted `"BH"`, `"holm"`, `"hochberg"`, `"hommel"`, `"bonferroni"`, `"BY"`, `"fdr"` and `"none"`. Default as `"BH"`.

**Convert gene ID to SYMBOL**

If you want to convert entrez gene id to gene SYMBOL name, choose Yes. Default: No.

**Minimal and maximal size of each geneSet**

Set minimal and maximal size of each geneSet for analyzing. Default as 10 and 500.

------

==========
**Output**
==========

An CSV file included all enrichment pathways.

Example - **Single Count Matrix**:

    =============== =============================================== =========== ===========
    ID               Description                                    GeneRatio   BgRatio
    =============== =============================================== =========== ===========
    R-HSA-69618     Mitotic Spindle Checkpoint                      22/326      113/10704
    R-HSA-2500257   Resolution of Sister Chromatid Cohesion         23/326      126/10704
    R-HSA-141424    Amplification of signal from the kinetochores	20/326      96/10704
    R-HSA-9648025   EML4 and NUDC in mitotic spindle formation		20/326      117/10704
    R-HSA-5663220   RHO GTPases Activate Formins                    21/326      140/10704
    =============== =============================================== =========== ===========
    

    ]]></help>
    
    <citations>
        <citation type="doi">10.1039/c5mb00663e</citation>
    </citations>
    
</tool>